@page "/convex_hull_output"
@using Problem.FenceTransport
@using ProjektZaliczeniowy_AiSD2.States
@inherits ProblemOutputBase<ConvexHullOutput>

@inject NavigationManager Navigation
@inject IFenceState FenceState

<div class="convex_hull">
    <WoodenTitle>Indeksy otoczki wypukłej:</WoodenTitle>

    <div class="board">
        <div class="table_wrapper">
            <table>
                <thead>
                <tr>
                    <th>Indeks</th>
                </tr>
                </thead>
                <tbody>
                    @if (_outputData is not null && _outputData.HullIndexes is not null)
                    {
                        @foreach (var i in _outputData.HullIndexes)
                        {
                            <tr>
                                <td>@i</td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>
    <div class="next_button">
        <OldButton @onclick="NextProblem">Przejdź Dalej</OldButton>
    </div>
</div>

@code {
    private ConvexHullOutput? _outputData;

    private FenceTransportInputData? _inputData;

    protected override async Task OnInitializedAsync()
    {
        if (ProblemState is not null)
        {
            _outputData = await ProblemState.GetProblemOutputData<ConvexHullOutput>();
            _inputData = await ProblemState.GetProblemInputData<FenceTransportInputData>();
            _inputData.ConvexHullOutput = _outputData;
            await ProblemState.SetProblemInputData(_inputData);
            SaveFenceToFenceState();
        }
    }

    private void SaveFenceToFenceState()
    {
        FenceState.SetFence(_inputData!, _outputData!);
    }
    private void NextProblem()
    {
        Navigation.NavigateTo("fence_transport");
    }
}