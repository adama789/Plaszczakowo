@page "/input/keyboard/{ProblemName}"

@using ElectronNET.API
@using ElectronNET.API.Entities
@using System.Text.Json
@using Problem.PhraseCorrection
@using ProjektZaliczeniowy_AiSD2.Components.States

@inherits InputMethodBase;
@inject NavigationManager Navigator;
@inject IProblemState ProblemState;

<ReturnButton ButtonPosition="HangingButton.HangingButtonPosition.Right"></ReturnButton>
<div class="keyboard_input">
    <WoodenTitle>Wprowad≈∫ tekst z klawiatury</WoodenTitle>
    
    <div class="keyboard_input__input">
        <textarea @bind="_inputText"></textarea>
        <OldButton @onclick="GoToProblemPage">Wczytaj</OldButton>
    </div>
    
</div>

@code {
    private string _inputText = "";

    private string PrepareInputData()
    {
        string input = "";
        PhraseCorrectionInputData data = new(_inputText);
        input = JsonSerializer.Serialize(data);
        return input;
    }

    private async void GoToProblemPage()
    {
        string input = PrepareInputData();
        await ProblemState.SetProblemJsonInputData(input);
        Navigator.NavigateTo($"/{ProblemName}");
    }

}